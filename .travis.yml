language: csharp
dist: xenial
sudo: required
mono: none
dotnet: 2.0.0
solution: Dibware.Salon.sln
addons:
  sonarcloud:
    organization: "dibley1973-github" # the key of the org you chose at step #3
    token:
      secure: $SONAR_TOKEN
branches:
  only:
    - master

install:
  - git fetch --unshallow --tags
  - dotnet tool install --global dotnet-sonarscanner

before_script:
  - chmod +x build.sh
  - chmod +x run-tests.sh

script:
  - dotnet sonarscanner begin /k:"company:project" /n:"Project" /v:"#.#.#" /o:"companyname" /d:sonar.host.url="https://sonarcloud.io" /d:sonar.login="$SONAR_TOKEN" /d:sonar.language="cs" /d:sonar.exclusions="**/bin/**/*,**/obj/**/*" /d:sonar.cs.opencover.reportsPaths="lcov.opencover.xml" || true
  - ./build.sh
  - ./run-tests.sh
  - dotnet sonarscanner end /d:sonar.login="$SONAR_TOKEN" || true

